#!/usr/bin/python3


data1='''
D8005AC2A8F0
'''.strip().splitlines()
data2='''
220D700071F39F9C6BC92D4A6713C737B3E98783004AC0169B4B99F93CFC31AC4D8A4BB89E9D654D216B80131DC0050B20043E27C1F83240086C468A311CC0188DB0BA12B00719221D3F7AF776DC5DE635094A7D2370082795A52911791ECB7EDA9CFD634BDED14030047C01498EE203931BF7256189A593005E116802D34673999A3A805126EB2B5BEEBB823CB561E9F2165492CE00E6918C011926CA005465B0BB2D85D700B675DA72DD7E9DBE377D62B27698F0D4BAD100735276B4B93C0FF002FF359F3BCFF0DC802ACC002CE3546B92FCB7590C380210523E180233FD21D0040001098ED076108002110960D45F988EB14D9D9802F232A32E802F2FDBEBA7D3B3B7FB06320132B0037700043224C5D8F2000844558C704A6FEAA800D2CFE27B921CA872003A90C6214D62DA8AA9009CF600B8803B10E144741006A1C47F85D29DCF7C9C40132680213037284B3D488640A1008A314BC3D86D9AB6492637D331003E79300012F9BDE8560F1009B32B09EC7FC0151006A0EC6082A0008744287511CC0269810987789132AC600BD802C00087C1D88D05C001088BF1BE284D298005FB1366B353798689D8A84D5194C017D005647181A931895D588E7736C6A5008200F0B802909F97B35897CFCBD9AC4A26DD880259A0037E49861F4E4349A6005CFAD180333E95281338A930EA400824981CC8A2804523AA6F5B3691CF5425B05B3D9AF8DD400F9EDA1100789800D2CBD30E32F4C3ACF52F9FF64326009D802733197392438BF22C52D5AD2D8524034E800C8B202F604008602A6CC00940256C008A9601FF8400D100240062F50038400970034003CE600C70C00F600760C00B98C563FB37CE4BD1BFA769839802F400F8C9CA79429B96E0A93FAE4A5F32201428401A8F508A1B0002131723B43400043618C2089E40143CBA748B3CE01C893C8904F4E1B2D300527AB63DA0091253929E42A53929E420
'''.strip().splitlines()

data=data2

#data = [int(line) for line in data[0].split(',')]
#data = [int(line) for line in data]

#a=format(int(data[0], 16), 'b')


num_of_bits = len(data[0])*4

a=bin(int(data[0], 16))[2:].zfill(len(data[0])*4)
print(a)
print('TYPE', a[3:6])
answer=0

def p():
	global a, answer
	v,t,i=int(a[0:3], 2), int(a[3:6], 2), int(a[6:7], 2)
	answer+=v
	print(v,t,i)
	if t==4:
		a=a[6:]
		output=0
		while a[0]=='1':
			print('literal', a[1:5])
			output*=16
			output+=int(a[1:5], 2)
			a=a[5:]
		print('literal', a[1:5])
		output*=16
		output+=int(a[1:5], 2)
		a=a[5:]
		print('literal answer', output)
	else:
		if i==0:
			print('bits')
			l=int(a[7:22], 2)
			a=a[22:]
			oldLength=len(a)
			data=[]
			while oldLength-len(a)<l:
				print('recurse', a)
				data.append(p())

		else:
			print('packets')
			packets=int(a[7:18], 2)
			a=a[18:]
			data=[]
			for i in range(packets):
				data.append(p())
		if t==0:
			print('sum')
			output=sum(data)
		elif t==1:
			print('product')
			output=1
			for i in data:
				output*=i
		elif t==2:
			print('min')
			output=min(data)
		elif t==3:
			print('max')
			output=max(data)
		elif t==5:
			print('>')
			output=1 if data[0] > data[1] else 0
		elif t==6:
			print('<')
			output=1 if data[0] < data[1] else 0
		elif t==7:
			print('=')
			output=1 if data[0] == data[1] else 0
	return output


print(p())
print(answer)

